# vim:ft=plumed
# choose units - by default PLUMED uses kj/mol, nm, and ps
# UNITS ENERGY=kcal/mol LENGTH=A

# UNTS !!!!!!!!!

# PDB that provides information on the molecules that are present in your system.
MOLINFO STRUCTURE=GAGA_native.pdb
WHOLEMOLECULES ENTITY0=1-263


####################################################################################################
# gHBfix RESTRAINT SECTION
####################################################################################################

group_nh_n: COORDINATION PAIR GROUPA=19,22,23,19,19,22,22,23,23,19,19,19,22,22,22,23,23,23,19,19,22,22,23,23,19,19,19,22,22,22,23,23,23,19,19,22,22,23,23,19,22,23,52,52,53,53,52,52,53,53,52,52,52,53,53,53,52,52,53,53,52,52,52,53,53,53,52,52,53,53,52,53,84,84,87,87,88,88,84,87,88,84,84,84,87,87,87,88,88,88,84,84,87,87,88,88,84,84,84,87,87,87,88,88,88,84,84,87,87,88,88,84,87,88,117,117,118,118,117,118,117,117,118,118,117,117,118,118,117,117,117,118,118,118,117,117,118,118,117,118,151,151,154,154,155,155,151,154,155,151,151,154,154,155,155,151,151,151,154,154,154,155,155,155,151,151,151,154,154,154,155,155,155,151,151,154,154,155,155,151,154,155,184,184,185,185,184,185,184,184,185,185,184,184,184,185,185,185,184,184,185,185,184,184,185,185,184,185,218,218,221,221,222,222,218,221,222,218,218,221,221,222,222,218,218,218,221,221,221,222,222,222,218,218,221,221,222,222,218,218,218,221,221,221,222,222,222,218,221,222,251,251,252,252,251,252,251,251,252,252,251,251,251,252,252,252,251,251,252,252,251,251,251,252,252,252,251,251,252,252 GROUPB=54,54,54,79,89,79,89,79,89,113,119,122,113,119,122,113,119,122,146,156,146,156,146,156,180,186,189,180,186,189,180,186,189,213,223,213,223,213,223,253,253,253,14,24,14,24,79,89,79,89,113,119,122,113,119,122,146,156,146,156,180,186,189,180,186,189,213,223,213,223,253,253,14,24,14,24,14,24,54,54,54,113,119,122,113,119,122,113,119,122,146,156,146,156,146,156,180,186,189,180,186,189,180,186,189,213,223,213,223,213,223,253,253,253,14,24,14,24,54,54,79,89,79,89,146,156,146,156,180,186,189,180,186,189,213,223,213,223,253,253,14,24,14,24,14,24,54,54,54,79,89,79,89,79,89,113,119,122,113,119,122,113,119,122,180,186,189,180,186,189,180,186,189,213,223,213,223,213,223,253,253,253,14,24,14,24,54,54,79,89,79,89,113,119,122,113,119,122,146,156,146,156,213,223,213,223,253,253,14,24,14,24,14,24,54,54,54,79,89,79,89,79,89,113,119,122,113,119,122,113,119,122,146,156,146,156,146,156,180,186,189,180,186,189,180,186,189,253,253,253,14,24,14,24,54,54,79,89,79,89,113,119,122,113,119,122,146,156,146,156,180,186,189,180,186,189,213,223,213,223 SWITCH={MATHEVAL FUNC=((-2092.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.3-x)+((-2092.0000000000)*(0.1)*(2*x-0.5))*step(x-0.3)+((2615.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.28-x)+((2615.0000000000)*(0.08)*(2*x-0.48))*step(x-0.28) R_0=1.0}

group_oh_nbo: COORDINATION PAIR GROUPA=31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,62,62,62,62,62,62,62,62,62,62,62,62,62,62,96,96,96,96,96,96,96,96,96,96,96,96,96,96,129,129,129,129,129,129,129,129,129,129,129,129,129,129,163,163,163,163,163,163,163,163,163,163,163,163,163,163,196,196,196,196,196,196,196,196,196,196,196,196,196,196,230,230,230,230,230,230,230,230,230,230,230,230,230,230,261,261,263,263,261,261,263,263,261,261,263,263,261,261,263,263,261,261,263,263,261,261,263,263,261,261,263,263 GROUPB=34,35,34,35,65,66,65,66,99,100,99,100,132,133,132,133,166,167,166,167,199,200,199,200,233,234,233,234,34,35,65,66,99,100,132,133,166,167,199,200,233,234,34,35,65,66,99,100,132,133,166,167,199,200,233,234,34,35,65,66,99,100,132,133,166,167,199,200,233,234,34,35,65,66,99,100,132,133,166,167,199,200,233,234,34,35,65,66,99,100,132,133,166,167,199,200,233,234,34,35,65,66,99,100,132,133,166,167,199,200,233,234,34,35,34,35,65,66,65,66,99,100,99,100,132,133,132,133,166,167,166,167,199,200,199,200,233,234,233,234 SWITCH={MATHEVAL FUNC=((-2092.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.3-x)+((-2092.0000000000)*(0.1)*(2*x-0.5))*step(x-0.3)+((2615.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.28-x)+((2615.0000000000)*(0.08)*(2*x-0.48))*step(x-0.28) R_0=1.0}

group_oh_bo: COORDINATION PAIR GROUPA=1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,1,62,62,62,62,62,62,62,62,62,62,62,62,62,96,96,96,96,96,96,96,96,96,96,96,96,96,129,129,129,129,129,129,129,129,129,129,129,129,129,163,163,163,163,163,163,163,163,163,163,163,163,163,196,196,196,196,196,196,196,196,196,196,196,196,196,230,230,230,230,230,230,230,230,230,230,230,230,230,261,263,261,261,263,263,261,261,263,263,261,261,263,263,261,261,263,263,261,261,263,263,261,261,263,263,261,263 GROUPB=32,36,63,36,63,67,97,67,97,101,130,101,130,134,164,134,164,168,197,168,197,201,231,201,231,235,235,32,36,67,97,101,130,134,164,168,197,201,231,235,32,36,63,67,101,130,134,164,168,197,201,231,235,32,36,63,67,97,101,134,164,168,197,201,231,235,32,36,63,67,97,101,130,134,168,197,201,231,235,32,36,63,67,97,101,130,134,164,168,201,231,235,32,36,63,67,97,101,130,134,164,168,197,201,235,32,32,36,63,36,63,67,97,67,97,101,130,101,130,134,164,134,164,168,197,168,197,201,231,201,231,235,235 SWITCH={MATHEVAL FUNC=((-2092.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.3-x)+((-2092.0000000000)*(0.1)*(2*x-0.5))*step(x-0.3)+((2615.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.28-x)+((2615.0000000000)*(0.08)*(2*x-0.48))*step(x-0.28) R_0=1.0}


tot_NH-N: COMBINE ARG=group_nh_n COEFFICIENTS=0.756708 PERIODIC=NO
tot_OH-nbO: COMBINE ARG=group_oh_nbo COEFFICIENTS=-0.378354 PERIODIC=NO
tot_OH-bO: COMBINE ARG=group_oh_bo COEFFICIENTS=-0.378354 PERIODIC=NO

tot: COMBINE ARG=group_nh_n,group_oh_nbo,group_oh_bo COEFFICIENTS=0.756708,-0.378354,-0.378354 PERIODIC=NO

BIASVALUE ARG=tot_NH-N LABEL=all_NH-N
BIASVALUE ARG=tot_OH-nbO LABEL=all_OH-nbO
BIASVALUE ARG=tot_OH-bO LABEL=all_OH-bO

PRINT ARG=tot_NH-N,all_NH-N.bias,tot_OH-nbO,all_OH-nbO.bias,tot_OH-bO,all_OH-bO.bias,tot STRIDE=1000 FILE=check_HBfix.dat

# eRMSD with augmented cutoff, used for biasing.
# The value of the cutoff determines at which distance a pair of nucleobases is counted
# as a contact. An augmented value here allows forces to drive
# the system towards and away from native even when nucleobases are far from
# each other
DIST0: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-4,@lcs-5,@lcs-6,@lcs-7,@lcs-8 REFERENCE=GAGA_native.pdb CUTOFF=3.2

# eRMSD with standard cutoff (2.4), used for monitoring only.
# The cutoff employed here is the same used in the original paper
# describing the eRMSD metric. This value allows only proper contact to
# be included in the assessment of the structures.
DIST1: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-4,@lcs-5,@lcs-6,@lcs-7,@lcs-8 REFERENCE=GAGA_native.pdb

# metadynamics
metad: METAD ARG=DIST0 PACE=250 TAU=70 SIGMA=0.1 FILE=HILLS TEMP=298 BIASFACTOR=15 GRID_MIN=0 GRID_MAX=4.5 GRID_SPACING=0.02
# print colvar file
PRINT ARG=DIST0,DIST1,metad.bias FILE=COLVAR STRIDE=250
