# vim:ft=plumed
# PDB that provides information on the molecules that are present in your system.
MOLINFO STRUCTURE=UUCG_native.pdb
WHOLEMOLECULES ENTITY0=1-254

####################################################################################################
# gHBfix RESTRAINT SECTION
####################################################################################################

group_nh_n: COORDINATION PAIR GROUPA=19,22,23,19,22,23,19,19,22,22,23,23,19,19,22,22,23,23,19,22,23,52,52,53,53,52,53,52,52,53,53,52,52,53,53,52,53,84,84,84,84,84,84,84,84,84,114,114,114,114,114,114,114,114,114,143,143,144,144,143,144,143,143,144,144,143,143,144,144,143,144,175,175,178,178,179,179,175,178,179,175,178,179,175,175,178,178,179,179,175,178,179,209,209,212,212,213,213,209,212,213,209,212,213,209,209,212,212,213,213,209,212,213,242,242,243,243,242,243,242,243,242,242,243,243,242,242,243,243 GROUPB=54,54,54,145,145,145,170,180,170,180,170,180,204,214,204,214,204,214,244,244,244,14,24,14,24,145,145,170,180,170,180,204,214,204,214,244,244,14,24,54,145,170,180,204,214,244,14,24,54,145,170,180,204,214,244,14,24,14,24,54,54,170,180,170,180,204,214,204,214,244,244,14,24,14,24,14,24,54,54,54,145,145,145,204,214,204,214,204,214,244,244,244,14,24,14,24,14,24,54,54,54,145,145,145,170,180,170,180,170,180,244,244,244,14,24,14,24,54,54,145,145,170,180,170,180,204,214,204,214 SWITCH={CUSTOM FUNC=((-2092.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.3-x)+((-2092.0000000000)*(0.1)*(2*x-0.5))*step(x-0.3)+((2615.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.28-x)+((2615.0000000000)*(0.08)*(2*x-0.48))*step(x-0.28) R_0=1.0}

group_oh_nbo: COORDINATION PAIR GROUPA=31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,62,62,62,62,62,62,62,62,62,62,62,62,62,62,92,92,92,92,92,92,92,92,92,92,92,92,92,92,122,122,122,122,122,122,122,122,122,122,122,122,122,122,153,153,153,153,153,153,153,153,153,153,153,153,153,153,187,187,187,187,187,187,187,187,187,187,187,187,187,187,221,221,221,221,221,221,221,221,221,221,221,221,221,221,252,252,254,254,252,252,254,254,252,252,254,254,252,252,254,254,252,252,254,254,252,252,254,254,252,252,254,254 GROUPB=34,35,34,35,65,66,65,66,95,96,95,96,125,126,125,126,156,157,156,157,190,191,190,191,224,225,224,225,34,35,65,66,95,96,125,126,156,157,190,191,224,225,34,35,65,66,95,96,125,126,156,157,190,191,224,225,34,35,65,66,95,96,125,126,156,157,190,191,224,225,34,35,65,66,95,96,125,126,156,157,190,191,224,225,34,35,65,66,95,96,125,126,156,157,190,191,224,225,34,35,65,66,95,96,125,126,156,157,190,191,224,225,34,35,34,35,65,66,65,66,95,96,95,96,125,126,125,126,156,157,156,157,190,191,190,191,224,225,224,225 SWITCH={CUSTOM FUNC=((-2092.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.3-x)+((-2092.0000000000)*(0.1)*(2*x-0.5))*step(x-0.3)+((2615.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.28-x)+((2615.0000000000)*(0.08)*(2*x-0.48))*step(x-0.28) R_0=1.0}

group_oh_bo: COORDINATION PAIR GROUPA=1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,31,1,1,31,1,62,62,62,62,62,62,62,62,62,62,62,62,62,92,92,92,92,92,92,92,92,92,92,92,92,92,122,122,122,122,122,122,122,122,122,122,122,122,122,153,153,153,153,153,153,153,153,153,153,153,153,153,187,187,187,187,187,187,187,187,187,187,187,187,187,221,221,221,221,221,221,221,221,221,221,221,221,221,252,254,252,252,254,254,252,252,254,254,252,252,254,254,252,252,254,254,252,252,254,254,252,252,254,254,252,254 GROUPB=32,36,63,36,63,67,93,67,93,97,123,97,123,127,154,127,154,158,188,158,188,192,222,192,222,226,226,32,36,67,93,97,123,127,154,158,188,192,222,226,32,36,63,67,97,123,127,154,158,188,192,222,226,32,36,63,67,93,97,127,154,158,188,192,222,226,32,36,63,67,93,97,123,127,158,188,192,222,226,32,36,63,67,93,97,123,127,154,158,192,222,226,32,36,63,67,93,97,123,127,154,158,188,192,226,32,32,36,63,36,63,67,93,67,93,97,123,97,123,127,154,127,154,158,188,158,188,192,222,192,222,226,226 SWITCH={CUSTOM FUNC=((-2092.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.3-x)+((-2092.0000000000)*(0.1)*(2*x-0.5))*step(x-0.3)+((2615.0000000000)*(0.2-x)^2)*step(x-0.2)*step(0.28-x)+((2615.0000000000)*(0.08)*(2*x-0.48))*step(x-0.28) R_0=1.0}


tot_NH-N: COMBINE ARG=group_nh_n COEFFICIENTS=@replicas:{1.0000000,0.9546000,0.9112610,0.8698900,0.8303970,0.7926970,0.7567080,0.7223540,0.6895590,0.6582530,0.6283680,0.5998400} PERIODIC=NO
tot_OH-nbO: COMBINE ARG=group_oh_nbo COEFFICIENTS=@replicas:{-0.5000000,-0.4773000,-0.4556305,-0.4349450,-0.4151985,-0.3963485,-0.3783540,-0.3611770,-0.3447795,-0.3291265,-0.3141840,-0.2999200} PERIODIC=NO
tot_OH-bO: COMBINE ARG=group_oh_bo COEFFICIENTS=@replicas:{-0.5000000,-0.4773000,-0.4556305,-0.4349450,-0.4151985,-0.3963485,-0.3783540,-0.3611770,-0.3447795,-0.3291265,-0.3141840,-0.2999200} PERIODIC=NO

##tot: COMBINE ARG=group_nh_n,group_nh_o,group_oh_nbo,group_oh_bo COEFFICIENTS=0.5,0.5,-0.5,-0.5 PERIODIC=NO

BIASVALUE ARG=tot_NH-N LABEL=all_NH-N
BIASVALUE ARG=tot_OH-nbO LABEL=all_OH-nbO
BIASVALUE ARG=tot_OH-bO LABEL=all_OH-bO

PRINT ARG=tot_NH-N,all_NH-N.bias,tot_OH-nbO,all_OH-nbO.bias,tot_OH-bO,all_OH-bO.bias STRIDE=2500 FILE=check_HBfix.dat

# eRMSD with augmented cutoff, used for biasing.
# The value of the cutoff determines at which distance a pair of nucleobases is counted
# as a contact. An augmented value here allows forces to drive
# the system towards and away from native even when nucleobases are far from
# each other
DIST0: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-4,@lcs-5,@lcs-6,@lcs-7,@lcs-8 REFERENCE=UUCG_native.pdb CUTOFF=3.2

# eRMSD with standard cutoff (2.4), used for monitoring only.
# The cutoff employed here is the same used in the original paper
# describing the eRMSD metric. This value allows only proper contact to
# be included in the assessment of the structures.
DIST1: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-4,@lcs-5,@lcs-6,@lcs-7,@lcs-8 REFERENCE=UUCG_native.pdb

# metadynamics
metad: METAD ARG=DIST0 PACE=250 TAU=70 SIGMA=0.1 FILE=HILLS TEMP=298 BIASFACTOR=15 GRID_MIN=0 GRID_MAX=4.5 GRID_SPACING=0.02
# print colvar file
PRINT ARG=DIST0,DIST1,metad.bias FILE=COLVAR STRIDE=250
