# vim:ft=plumed
# PDB that provides information on the molecules that are present in your system.
LOAD FILE=./GHBFIX.cpp

MOLINFO STRUCTURE=UUCG_native.pdb
WHOLEMOLECULES ENTITY0=1-254

#DEBUG DETAILED_TIMERS

####################################################################################################
# gHBfix RESTRAINT SECTION
####################################################################################################

#! GroupA and GroupB are all relevant donors and acceptors. D_0, D_MAX and C have to be defined according to the gHBfix switching function - default values printed (Kuehrova, Mlynsky et al., JCTC 2019). Each relevant type of donor and acceptor are labeled with an integer (typesTable.dat) and eta/scaling parameters are specified (scalingParameters.dat).
group_1: GHBFIX PAIR GROUPA=19,19,19,19,22,22,22,22,23,23,23,23,31,31,31,31,31,1,1,1,1,1,1,19,19,19,19,19,19,19,19,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,31,31,31,31,31,31,31,31,1,1,1,1,1,1,1,1,19,19,19,19,19,19,19,19,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,31,31,31,31,31,31,31,31,1,1,1,1,1,1,1,1,19,19,19,19,19,19,19,19,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,31,31,31,31,31,31,31,31,1,1,1,1,1,1,1,1,19,19,19,19,19,19,19,19,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,31,31,31,31,31,31,31,31,1,1,1,1,1,1,1,1,19,19,19,19,19,19,19,19,19,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,31,31,31,31,31,31,31,31,31,1,1,1,1,1,1,1,1,1,19,19,19,19,19,19,19,19,19,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,31,31,31,31,31,31,31,31,31,1,1,1,1,1,1,1,1,1,19,19,19,19,19,19,19,19,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,31,31,31,31,31,31,31,31,1,1,1,1,1,1,1,1,52,52,52,52,52,52,52,53,53,53,53,53,53,53,62,62,62,62,62,62,62,52,52,52,52,52,52,53,53,53,53,53,53,62,62,62,62,62,62,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,62,62,62,62,62,62,62,62,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,62,62,62,62,62,62,62,62,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,62,62,62,62,62,62,62,62,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,62,62,62,62,62,62,62,62,62,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,62,62,62,62,62,62,62,62,62,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,62,62,62,62,62,62,62,62,84,84,84,84,84,84,84,92,92,92,92,92,92,92,84,84,84,84,84,84,84,84,92,92,92,92,92,92,92,92,84,84,84,84,84,84,92,92,92,92,92,92,84,84,84,84,84,84,84,84,92,92,92,92,92,92,92,92,84,84,84,84,84,84,84,84,92,92,92,92,92,92,92,92,84,84,84,84,84,84,84,84,84,92,92,92,92,92,92,92,92,92,84,84,84,84,84,84,84,84,84,92,92,92,92,92,92,92,92,92,84,84,84,84,84,84,84,84,92,92,92,92,92,92,92,92,114,114,114,114,114,114,114,122,122,122,122,122,122,122,114,114,114,114,114,114,114,114,122,122,122,122,122,122,122,122,114,114,114,114,114,114,114,114,122,122,122,122,122,122,122,122,114,114,114,114,114,114,122,122,122,122,122,122,114,114,114,114,114,114,114,114,122,122,122,122,122,122,122,122,114,114,114,114,114,114,114,114,114,122,122,122,122,122,122,122,122,122,114,114,114,114,114,114,114,114,114,122,122,122,122,122,122,122,122,122,114,114,114,114,114,114,114,114,122,122,122,122,122,122,122,122,143,143,143,143,143,143,143,144,144,144,144,144,144,144,153,153,153,153,153,153,153,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,153,153,153,153,153,153,153,153,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,153,153,153,153,153,153,153,153,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,153,153,153,153,153,153,153,153,143,143,143,143,143,143,144,144,144,144,144,144,153,153,153,153,153,153,143,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,144,153,153,153,153,153,153,153,153,153,143,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,144,153,153,153,153,153,153,153,153,153,143,143,143,143,143,143,143,143,144,144,144,144,144,144,144,144,153,153,153,153,153,153,153,153,175,175,175,175,175,175,175,178,178,178,178,178,178,178,179,179,179,179,179,179,179,187,187,187,187,187,187,187,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,187,187,187,187,187,187,187,187,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,187,187,187,187,187,187,187,187,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,187,187,187,187,187,187,187,187,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,187,187,187,187,187,187,187,187,175,175,175,175,175,175,178,178,178,178,178,178,179,179,179,179,179,179,187,187,187,187,187,187,187,175,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,179,187,187,187,187,187,187,187,187,187,175,175,175,175,175,175,175,175,178,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,187,187,187,187,187,187,187,187,209,209,209,209,209,209,209,212,212,212,212,212,212,212,213,213,213,213,213,213,213,221,221,221,221,221,221,221,209,209,209,209,209,209,209,209,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,221,221,221,221,221,221,221,221,209,209,209,209,209,209,209,209,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,221,221,221,221,221,221,221,221,209,209,209,209,209,209,209,209,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,221,221,221,221,221,221,221,221,209,209,209,209,209,209,209,209,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,221,221,221,221,221,221,221,221,209,209,209,209,209,209,209,209,209,212,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,213,221,221,221,221,221,221,221,221,221,209,209,209,209,209,209,212,212,212,212,212,212,213,213,213,213,213,213,221,221,221,221,221,221,221,209,209,209,209,209,209,209,209,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,221,221,221,221,221,221,221,221,242,242,242,242,242,242,242,243,243,243,243,243,243,243,252,252,252,252,252,252,252,254,254,254,254,254,254,254,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,252,252,252,252,252,252,252,252,254,254,254,254,254,254,254,254,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,252,252,252,252,252,252,252,252,254,254,254,254,254,254,254,254,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,252,252,252,252,252,252,252,252,254,254,254,254,254,254,254,254,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,252,252,252,252,252,252,252,252,254,254,254,254,254,254,254,254,242,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,243,252,252,252,252,252,252,252,252,252,254,254,254,254,254,254,254,254,254,242,242,242,242,242,242,242,242,242,243,243,243,243,243,243,243,243,243,252,252,252,252,252,252,252,252,252,254,254,254,254,254,254,254,254,254,242,242,242,242,242,242,243,243,243,243,243,243,252,252,252,252,252,252,254,254,254,254,254,254 GROUPB=32,30,2,8,32,30,2,8,32,30,2,8,2,8,17,14,24,32,30,8,17,14,24,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,34,35,36,63,61,42,34,35,36,63,61,42,34,35,36,42,56,54,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,32,30,2,8,17,14,24,32,30,2,8,17,14,24,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,65,66,67,93,91,73,65,66,67,73,82,86,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,32,30,2,8,17,14,24,32,30,2,8,17,14,24,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,95,96,97,123,121,103,95,96,97,103,112,116,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,125,126,127,154,152,133,125,126,127,154,152,133,125,126,127,133,147,145,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,156,157,158,188,186,164,156,157,158,188,186,164,156,157,158,188,186,164,156,157,158,164,173,170,180,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,190,191,192,222,220,198,190,191,192,222,220,198,190,191,192,222,220,198,190,191,192,198,207,204,214,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,224,225,226,251,253,232,246,244,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,32,30,2,8,17,14,24,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,34,35,36,63,61,42,56,54,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,65,66,67,93,91,73,82,86,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,95,96,97,123,121,103,112,116,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,125,126,127,154,152,133,147,145,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,156,157,158,188,186,164,173,170,180,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,190,191,192,222,220,198,207,204,214,224,225,226,251,253,232,224,225,226,251,253,232,224,225,226,232,246,244,224,225,226,232,246,244 D_0=0.2 D_MAX=0.3 C=0.8 TYPES=typesTable.dat PARAMS=scalingParameters.dat

tot_1: COMBINE ARG=group_1 COEFFICIENTS=@replicas:{1.0000000,0.9546000,0.9112610,0.8698900,0.8303970,0.7926970,0.7567080,0.7223540,0.6895590,0.6582530,0.6283680,0.5998400} PERIODIC=NO

BIASVALUE ARG=tot_1 LABEL=all_1

PRINT ARG=tot_1,all_1.bias STRIDE=250 FILE=check_ghbfix-uncg19.dat

# eRMSD with augmented cutoff, used for biasing.
# The value of the cutoff determines at which distance a pair of nucleobases is counted
# as a contact. An augmented value here allows forces to drive
# the system towards and away from native even when nucleobases are far from
# each other
DIST0: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-4,@lcs-5,@lcs-6,@lcs-7,@lcs-8 REFERENCE=UUCG_native.pdb CUTOFF=3.2

# eRMSD with standard cutoff (2.4), used for monitoring only.
# The cutoff employed here is the same used in the original paper
# describing the eRMSD metric. This value allows only proper contact to
# be included in the assessment of the structures.
DIST1: ERMSD ATOMS=@lcs-1,@lcs-2,@lcs-3,@lcs-4,@lcs-5,@lcs-6,@lcs-7,@lcs-8 REFERENCE=UUCG_native.pdb

# metadynamics
metad: METAD ARG=DIST0 PACE=250 TAU=70 SIGMA=0.1 FILE=HILLS TEMP=298 BIASFACTOR=15 GRID_MIN=0 GRID_MAX=4.5 GRID_SPACING=0.02
# print colvar file
PRINT ARG=DIST0,DIST1,metad.bias FILE=COLVAR STRIDE=250

